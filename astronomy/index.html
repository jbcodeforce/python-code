<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=../python/faq/ rel=prev><link href=../coding/dev-env/ rel=next><link rel=icon href=../assets/images/favicon.png><meta name=generator content="mkdocs-1.5.3, mkdocs-material-9.5.17"><title>Astronomy statistics and image processing - Python code studies</title><link rel=stylesheet href=../assets/stylesheets/main.bcfcd587.min.css><link rel=stylesheet href=../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../extra.css><script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#python-programming-for-astronomy class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=.. title="Python code studies" class="md-header__button md-logo" aria-label="Python code studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Python code studies </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Astronomy statistics and image processing </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/python-code title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=.. title="Python code studies" class="md-nav__button md-logo" aria-label="Python code studies" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg> </a> Python code studies </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/python-code title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1 checked> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Introduction </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=true> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Introduction </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=.. class=md-nav__link> <span class=md-ellipsis> Basic </span> </a> </li> <li class=md-nav__item> <a href=../python/python-summary/ class=md-nav__link> <span class=md-ellipsis> Summary </span> </a> </li> <li class=md-nav__item> <a href=../python/faq/ class=md-nav__link> <span class=md-ellipsis> Advanced </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Astronomy statistics and image processing </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Astronomy statistics and image processing </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pulsars class=md-nav__link> <span class=md-ellipsis> Pulsars </span> </a> </li> <li class=md-nav__item> <a href=#calculating-the-mean-median-stack-of-a-set-of-fits-images class=md-nav__link> <span class=md-ellipsis> Calculating the mean / median stack of a set of FITS images </span> </a> </li> <li class=md-nav__item> <a href=#agn-active-galactic-nucleus class=md-nav__link> <span class=md-ellipsis> AGN: Active Galactic Nucleus </span> </a> </li> <li class=md-nav__item> <a href=#cross-matching class=md-nav__link> <span class=md-ellipsis> Cross-matching </span> </a> </li> <li class=md-nav__item> <a href=#statistic-data-science-helps-astronomy class=md-nav__link> <span class=md-ellipsis> Statistic / data science helps Astronomy </span> </a> </li> <li class=md-nav__item> <a href=#exoplanets class=md-nav__link> <span class=md-ellipsis> Exoplanets </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex=0> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../coding/dev-env/ class=md-nav__link> <span class=md-ellipsis> Development environment </span> </a> </li> <li class=md-nav__item> <a href=../coding/uv/ class=md-nav__link> <span class=md-ellipsis> Project mgt with uv </span> </a> </li> <li class=md-nav__item> <a href=../coding/dp/ class=md-nav__link> <span class=md-ellipsis> Design patterns </span> </a> </li> <li class=md-nav__item> <a href=../coding/references/ class=md-nav__link> <span class=md-ellipsis> Code studies </span> </a> </li> <li class=md-nav__item> <a href=../coding/building-cli.md class=md-nav__link> <span class=md-ellipsis> Building CLI </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Data & AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Data & AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../data/pandas/ class=md-nav__link> <span class=md-ellipsis> Pandas </span> </a> </li> <li class=md-nav__item> <a href=../data/webcrawling/readme/ class=md-nav__link> <span class=md-ellipsis> Web Data </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/ML-studies class=md-nav__link> <span class=md-ellipsis> Python and data sciences </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Web App </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Web App </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../fastapi/ class=md-nav__link> <span class=md-ellipsis> FastAPI </span> </a> </li> <li class=md-nav__item> <a href=../flask/readme/ class=md-nav__link> <span class=md-ellipsis> Flask studies and basic samples </span> </a> </li> <li class=md-nav__item> <a href=../flask/flask-tdd-docker/ class=md-nav__link> <span class=md-ellipsis> Flask Rest microservice with TDD and Docker </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/jbcodeforce/python-code/tree/master/Flask/firstRESTapp class=md-nav__link> <span class=md-ellipsis> Flask webapp template with docker </span> </a> </li> <li class=md-nav__item> <a href=../python/pydantic/ class=md-nav__link> <span class=md-ellipsis> Pydantic </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex=0> <span class=md-ellipsis> Techno </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Techno </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../techno/aws/ class=md-nav__link> <span class=md-ellipsis> AWS </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/spark-studies class=md-nav__link> <span class=md-ellipsis> Python and Spark </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/kafka-studies class=md-nav__link> <span class=md-ellipsis> Kafka consumer and producer </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/ class=md-nav__link> <span class=md-ellipsis> Back to main </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#pulsars class=md-nav__link> <span class=md-ellipsis> Pulsars </span> </a> </li> <li class=md-nav__item> <a href=#calculating-the-mean-median-stack-of-a-set-of-fits-images class=md-nav__link> <span class=md-ellipsis> Calculating the mean / median stack of a set of FITS images </span> </a> </li> <li class=md-nav__item> <a href=#agn-active-galactic-nucleus class=md-nav__link> <span class=md-ellipsis> AGN: Active Galactic Nucleus </span> </a> </li> <li class=md-nav__item> <a href=#cross-matching class=md-nav__link> <span class=md-ellipsis> Cross-matching </span> </a> </li> <li class=md-nav__item> <a href=#statistic-data-science-helps-astronomy class=md-nav__link> <span class=md-ellipsis> Statistic / data science helps Astronomy </span> </a> </li> <li class=md-nav__item> <a href=#exoplanets class=md-nav__link> <span class=md-ellipsis> Exoplanets </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=python-programming-for-astronomy>Python programming for astronomy<a class=headerlink href=#python-programming-for-astronomy title="Permanent link">&para;</a></h1> <details class="- info"> <summary>Updates</summary> <p>Created 2019 Update 10/2025</p> </details> <h2 id=pulsars>Pulsars<a class=headerlink href=#pulsars title="Permanent link">&para;</a></h2> <p>In 1967, a Cambridge University Ph.D. Student named Jocelyn Bell found something strange in her radio Astronomy Data: a regular pulse.</p> <p>When an old large star runs out of nuclear fuel, it rapidly collapses under its own gravity. The star's core suddenly transforms into a super dense ball of neutrons, and the outer layers of the star bounce off in a massive explosion of light and energy, a supernova. </p> <p>The law of conservation of angular momentum says, that when a star collapses the rotation speeds up. So, a neutron star could be spinning anything from once a second to tens or even hundreds of times a second. Also stars have magnetic fields, neutron stars would have incredibly intense magnetic fields. Charged particles in the super-hot plasma surrounding a neutron star, would get funneled towards the stars magnetic poles and shot out into space as <strong>two intense beams</strong>. Combining with rapid rotation, it becomes a flashing beams across the universe: <strong>A Pulsar</strong></p> <p>The goal is to be able to answer: </p> <p><em>how many pulsars are detected in images taken with the Murchison Widefield Array telescope?</em> </p> <p>The array telescope, detects radio emission at frequencies between 80 and 300 megahertz. It has a very large field of view, which means it's great for doing large survey projects.</p> <p><img align=left alt src=images/MWA-image-1.png width=400> Images has using a grayscale to measure the flux density of emission from astronomical objects. Black is high flux density and gray is the background noise. </p> <p>Radio frequencies don't have color. These color maps are just used to accentuate different aspects of the intensity scale.</p> <p>In radio astronomy, flux density is measured in units of <strong>Janskys</strong>, which is equivalent to 10 to the power of -26 watts per square meter per hertz.</p> <p><img src="https://latex.codecogs.com/gif.latex?1&space;Jy&space;=&space;10^{-26}\frac{W}{m^{2}.Hz}" title="1 Jy = 10^{-26}\frac{W}{m^{2}.Hz}">)</p> <p>In other words, flux density is a measure of the spectral power received by a telescope detector of unit projected area.</p> <p>Astronomy images are usually stored in a file format called FITS, and to view them you can download software like DS9 or use an online tool like <a href=https://aladin.u-strasbg.fr/ >Aladin</a>.</p> <p>We typically call something a <strong>detection</strong>, if the flux density is more than five standard deviations higher than the noise in the local region.</p> <p>To search from non-detection, a special approach is used called <strong>Stacking</strong> which measures the statistical properties of a population we can't detect. Stacking works because the noise in a radio image is roughly random, with a Gaussian distribution centered on zero. When you add regions of an image that just have noise, the random numbers cancel out. But when you add regions of an image in which there are signals, the signals add together, increasing what we call the signal to noise ratio.</p> <p>Introduction to Pulsars (from CSIRO) Hobbs, M. (n.d.) from <a href=http://www.atnf.csiro.au/outreach/education/everyone/pulsars/index.html>http://www.atnf.csiro.au/outreach/education/everyone/pulsars/index.html</a></p> <p>Pulsar Properties (from NRAO, advanced) National Radio Astronomy Observatory. (2010) from <a href=http://www.cv.nrao.edu/course/astr534/Pulsars.html>http://www.cv.nrao.edu/course/astr534/Pulsars.html</a></p> <h2 id=calculating-the-mean-median-stack-of-a-set-of-fits-images>Calculating the mean / median stack of a set of FITS images<a class=headerlink href=#calculating-the-mean-median-stack-of-a-set-of-fits-images title="Permanent link">&para;</a></h2> <p>In Flexible Image Transport System (FITS) the image is stored in a numerical array, which we can load into a NumPy array. Opening a FITS file in <code>astropy</code> returns a HDU (Header/Data Unit) list. Each HDU stores headers and (optionally) image data. Here is a program to find the point in the image with the maximum intensity:</p> <div class=highlight><pre><span></span><code><span class=kn>from</span> <span class=nn>astropy.io</span> <span class=kn>import</span> <span class=n>fits</span>
<span class=k>def</span> <span class=nf>search_brightest_pixel</span><span class=p>(</span><span class=n>fname</span><span class=p>):</span>
  <span class=n>hdulist</span> <span class=o>=</span> <span class=n>fits</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=n>fname</span><span class=p>)</span>
  <span class=n>data</span> <span class=o>=</span> <span class=n>hdulist</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>data</span>
  <span class=n>nb_row</span><span class=p>,</span><span class=n>nb_col</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>shape</span>
  <span class=nb>max</span> <span class=o>=</span> <span class=mi>0</span>
  <span class=n>x</span> <span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>0</span><span class=p>)</span>
  <span class=k>for</span> <span class=n>r</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>nb_row</span><span class=p>):</span>
    <span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=n>nb_col</span><span class=p>):</span>
      <span class=k>if</span> <span class=n>data</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span> <span class=o>&gt;</span> <span class=nb>max</span> <span class=p>:</span>
          <span class=n>x</span> <span class=o>=</span> <span class=n>r</span>
          <span class=n>y</span> <span class=o>=</span> <span class=n>c</span>
          <span class=nb>max</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=n>r</span><span class=p>][</span><span class=n>c</span><span class=p>]</span>
  <span class=k>return</span> <span class=n>x</span><span class=p>,</span><span class=n>y</span>
</code></pre></div> <p>The problem is that we load all the image in memory.</p> <p>A better approach is to use the median (the middle of the sorted data set), as the mean is easily skewed by outliers. (See program: <a href=https://github.com/jbcodeforce/python-code/tree/master/astronomy/plot_mean_mediam.py>astronomy/plot_mean_mediam.py</a>)</p> <p>But getting median could get computational intensive and consuming a lot of memory as calculating the median requires all the data to be in memory at once. This is an issue in typical astrophysics calculations, which may use hundreds of thousands of FITS files. To compute the median we can use the statistics library, or the following approach:</p> <div class=highlight><pre><span></span><code><span class=n>fluxes</span> <span class=o>=</span> <span class=p>[</span><span class=mf>17.3</span><span class=p>,</span> <span class=mf>70.1</span><span class=p>,</span> <span class=mf>22.3</span><span class=p>,</span> <span class=mf>16.2</span><span class=p>,</span> <span class=mf>20.7</span><span class=p>]</span>
<span class=n>fluxes</span><span class=o>.</span><span class=n>sort</span><span class=p>()</span>
<span class=n>mid</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>fluxes</span><span class=p>)</span><span class=o>//</span><span class=mi>2</span>
<span class=n>median</span> <span class=o>=</span> <span class=n>fluxes</span><span class=p>[</span><span class=n>mid</span><span class=p>]</span>
<span class=c1># or for an even number of elements</span>
<span class=n>median</span> <span class=o>=</span> <span class=p>(</span><span class=n>fluxes</span><span class=p>[</span><span class=n>mid</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>+</span> <span class=n>fluxes</span><span class=p>[</span><span class=n>mid</span><span class=p>])</span><span class=o>/</span><span class=mi>2</span>
</code></pre></div> <p>or using <code>numpy</code>: </p> <div class=highlight><pre><span></span><code><span class=n>data</span> <span class=o>=</span> <span class=n>load_stack</span><span class=p>(</span><span class=n>fnames</span><span class=p>)</span>
<span class=n>stack</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>dstack</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
<span class=n>median</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>median</span><span class=p>(</span><span class=n>stack</span><span class=p>,</span> <span class=n>axis</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</code></pre></div> <p>To avoid loading all the data in memory, we can use the <a href=http://www.stat.cmu.edu/~ryantibs/papers/median.pdf>binapprox algorithm</a> to approximate the current median. The idea behind it is to find the median from the data's histogram.</p> <p>Starting from the left, if we sum up the counts in the histogram bins until we get to just over the expected mediam then we know the last bin we added must have contained the median. In fact it is better to search in bins around the standard devision of the mean. See <a href=https://github.com/jbcodeforce/python-code/blob/master/astronomy/Stacking/binapprox.py>Stacking/binapprox.py</a> code.</p> <h2 id=agn-active-galactic-nucleus>AGN: Active Galactic Nucleus<a class=headerlink href=#agn-active-galactic-nucleus title="Permanent link">&para;</a></h2> <p>Our eyes can only detect light and the visible part of the electromagnetic spectrum. Galaxy has Xray, visible and radio waves. At the center of the galaxy is a black hole, which has a huge impact on the galaxy's growth and formation. In cases where there is a lot of gas in the central region of the galaxy, this material can be accreted on to the black hole via an Accretion Disk, releasing a lot of energy in the process. This is what we call, an Active Galactic Nucleus. The radiation produced by the AGN is so bright that it can outshine the entire galaxy, producing far more energy than all of the galaxy's stars combined. It may form huge jets of strong magnetic fields emanating out from around the black hole. </p> <p><img align=right alt src=images/wave_length_black_hole.png width=400>Not all galaxies have AGN and not all AGN produce radio jets. While infrared radiation comes from the dusty regions that surround the black hole. The jets produce a lot of radio emissions and hot gas surrounding the central black hole region can produce x-ray emissions.</p> <p>Here is an image of combined wave lengths from visible, X-ray and radio:</p> <p><img alt="Galaxy in 3 wave lengths" src=images/galaxy-3w.png></p> <p>The material that accretes onto a black hole produce X-rays, because particle are becoming very hot. We can assess the presence of supermassive black hole by measuring powerful jets coming from a compact core, rapid changes in the luminosity of the galaxy nucleus, very high speed orbital motions of stars in the galactic nucleus.</p> <h2 id=cross-matching>Cross-matching<a class=headerlink href=#cross-matching title="Permanent link">&para;</a></h2> <p>When investigating astronomical objects, like active galactic nuclei (AGN), astronomers compare data about those objects from different telescopes at different wavelengths. This requires positional <strong>cross-matching</strong> to find the closest counterpart within a given radius on the sky.</p> <p>To create a catalog of objects from survey images, the source-finding software uses the same technics of going through all the pixels and find peaks that are <strong>statistically significant</strong>.</p> <p>How to calculate distance in the sky? Two objects in the same image are not in the same plane, we can compute the angular distance but they may be far aways on those line.</p> <p>The cross matching between 2 catalogs: The BSS catalogue lists the brightest sources from the AT20G radio survey while the SuperCOSMOS catalog lists galaxies observed by visible light surveys.</p> <p>The positions of stars, galaxies and other astronomical objects are usually recorded in either equatorial or Galactic coordinates.</p> <ul> <li><strong>Right ascension</strong>: the angle from the vernal equinox to the point, going east along the celestial equator. Given in hours-minutes-seconds (HMS). 1 hour = 15 degrees</li> <li><strong>Declination</strong>: the angle from the celestial equator to the point, going north (negative values indicate going south). Recorded in degrees-minutes-seconds (DMS) notation. A full circle is 360 degrees, each degree has 60 arcminutes and each arcminute has 60 arcseconds.</li> </ul> <p>The <strong>vernal equinox</strong> is the intersection of the celestial equator and the ecliptic where the ecliptic rises above the celestial equator going further east.</p> <figure> <img alt src=https://groklearning-cdn.com/modules/5JAX7dX9j4wdXKXRHwyECd/Ra_and_dec_demo.gif> </figure> <p>To crossmatch two catalogs we need to compare the angular distance between objects on the celestial sphere, which is the projected angle between objects as seen from Earth.</p> <p>See <a href=https://github.com/jbcodeforce/python-code/blob/master/astronomy/CrossMatching/cross-matching.py>cross-matching.py code</a> for in place comments and study. But this program is in O(n*m), there is a <a href=https://www.astropy.org/ >Astropy</a> library with cross marching, using <a href=https://en.wikipedia.org/wiki/K-d_tree>k-d-tree</a> as demonstrated in <a href=https://github.com/jbcodeforce/python-code/blob/master/astronomy/CrossMatching/cross-matching-astropy.py>this code</a>).</p> <figure> <img alt src=images/k-d-tree.png> </figure> <p>A k-d tree, or k-dimensional tree, is a way of representing the points in space in a recursive structure. K is the number of dimensions, which in our case are the two dimensions of our coordinate system, right ascension and declination. To construct a k-d tree, you have to recursively partition the space at the median point each time.</p> <p>The median point here in the x dimension is A. And so we split the plane at that point, and A becomes the root node of the tree. We then consider points to the left of A and split the plane in the y dimension. And again, at the median point, which is E. We repeat this process, alternating between the x and y dimensions, until the left-hand side of the tree is complete. </p> <p>Another important issue is how you can evaluate whether your matches are just chance coincidences. Or whether the galaxies have a real, physical association. When we can measure redshift for our objects, we can establish that they're at the same distance.</p> <p>Nearly all of our radio sources have an optical counterpart, which means we can classify them into two different categories.</p> <ul> <li> <p>Most of our radio galaxies are associated with quasars. Where we're looking towards the central black hole and can see the very energetic accretion disk. The radiation from the accretion disk is so bright that it outshines all of the stars in the galaxy. And therefore, looks just like a bright star, hence the name, quasi-stellar object, or quasar. <figure markdown=span> <img alt src=images/quasar.png> <capture>Quasar</capture> </figure></p> </li> <li> <p>The rest of our radio galaxies sit inside normal galaxies, where we can see a cloud of many stars grouped together. This could mean that the supermassive black hole has stopped accreting material. And the radio jets are remnants of past activity. </p> </li> </ul> <h2 id=statistic-data-science-helps-astronomy>Statistic / data science helps Astronomy<a class=headerlink href=#statistic-data-science-helps-astronomy title="Permanent link">&para;</a></h2> <p>Data could not answer directly what you want to find. so we can use probability theory to assess if the data provide answer. The approach is to try to assert hypothesis and derive what kind of data we should expect to see. Then you use the fit model approach by selecting the hypothesis that fit the best the data and throw away the ones that don't fit the data.</p> <p>2016 set a record for the biggest haul of exoplanets, when the Kepler team applied statistical validation to verify over a thousand new planets.</p> <h2 id=exoplanets>Exoplanets<a class=headerlink href=#exoplanets title="Permanent link">&para;</a></h2> <p>The science of exoplanets kicked off back in the late 1990s, the success of the space telescopes CoRoT and Kepler has really accelerated the field. Back in the 90s, we were discovering one or two planets a year, on average. </p> <figure> <img alt src=images/kepler-telescope.png> <capture>Kepler telescope</capture> </figure> <p>Kepler helps discover hundreds of new planets are being confirmed every year, with thousands more candidates being found.</p> <figure> <img alt src=images/exoplanets.png> <capture>Exoplanets per radion and orbital period.</capture> </figure> <p>The most common planets are the super earth. The <a href=https://exoplanetarchive.ipac.caltech.edu/ >NASA public catalog</a>. Here are some of the helpful attributes to consider for queries</p> <table> <thead> <tr> <th>Attribute</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>Kepler ID</td> <td>Unique target identification number for stars</td> </tr> <tr> <td>KOI name</td> <td>String identifier for the Kepler Object of Interest (KOI)</td> </tr> <tr> <td>Teff (K)</td> <td>Effective temperature of a star in Kelvin</td> </tr> <tr> <td>Radius</td> <td>Radius of stars and planets in units of solar radius/earth radius respectively</td> </tr> <tr> <td>Kepler name</td> <td>Unique string identifier for a confirmed exoplanet in the planet table</td> </tr> <tr> <td>Period</td> <td>Orbital period of a planet in units of days</td> </tr> <tr> <td>Status</td> <td>Status of a discovered KOI in the planet table, e.g. "confirmed" or "false positive"</td> </tr> <tr> <td>Teq</td> <td>Equilibrium temperature of a planet in Kelvin</td> </tr> </tbody> </table> <p><a href=https://duckdb.org/docs/stable/sql/introduction.html>Duckdb</a> can be used to read the exoplanet last update:</p> <div class=highlight><pre><span></span><code><span class=k>create</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>exoplanets</span><span class=w> </span><span class=k>as</span>
<span class=k>select</span><span class=w> </span><span class=o>*</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>read_csv_auto</span><span class=p>(</span><span class=s1>&#39;./cumulative_2025.10.12.csv&#39;</span><span class=p>);</span>
<span class=o>#</span><span class=w> </span><span class=n>see</span><span class=w> </span><span class=k>structure</span>
<span class=k>show</span><span class=w> </span><span class=k>table</span><span class=w> </span><span class=n>exoplanets</span><span class=p>;</span>
</code></pre></div> <p>Some interesting queries:</p> <div class=highlight><pre><span></span><code><span class=k>SELECT</span><span class=w> </span><span class=n>koi_name</span><span class=p>,</span><span class=w> </span><span class=n>radius</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>exoplanets</span><span class=w> </span><span class=k>ORDER</span><span class=w> </span><span class=k>BY</span><span class=w> </span><span class=n>radius</span><span class=w> </span><span class=k>DESC</span><span class=w> </span><span class=k>LIMIT</span><span class=w> </span><span class=mi>5</span><span class=p>;</span>
<span class=o>#</span><span class=w> </span><span class=k>analyse</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=k>size</span><span class=w> </span><span class=k>of</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>unconfirmed</span><span class=w> </span><span class=n>exoplanets</span><span class=w> </span><span class=p>(</span><span class=n>kepler_name</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>null</span><span class=p>).</span>
<span class=k>SELECT</span><span class=w> </span><span class=k>MIN</span><span class=p>(</span><span class=n>radius</span><span class=p>),</span><span class=w> </span><span class=k>MAX</span><span class=p>(</span><span class=n>radius</span><span class=p>),</span><span class=w> </span><span class=k>AVG</span><span class=p>(</span><span class=n>radius</span><span class=p>),</span><span class=w> </span><span class=n>STDDEV</span><span class=p>(</span><span class=n>radius</span><span class=p>)</span><span class=w> </span><span class=k>FROM</span><span class=w> </span><span class=n>Planet</span><span class=w> </span><span class=k>where</span><span class=w> </span><span class=n>kepler_name</span><span class=w> </span><span class=k>is</span><span class=w> </span><span class=k>NULL</span><span class=p>;</span>
<span class=o>#</span><span class=w> </span><span class=n>how</span><span class=w> </span><span class=n>many</span><span class=w> </span><span class=n>planets</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>the</span><span class=w> </span><span class=n>Planet</span><span class=w> </span><span class=k>database</span><span class=w> </span><span class=k>are</span><span class=w> </span><span class=k>in</span><span class=w> </span><span class=n>a</span><span class=w> </span><span class=n>multi</span><span class=o>-</span><span class=n>planet</span><span class=w> </span><span class=k>system</span>
<span class=k>select</span><span class=w> </span><span class=n>kepler_id</span><span class=p>,</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>koi_name</span><span class=p>)</span><span class=w> </span><span class=k>from</span><span class=w> </span><span class=n>Planet</span><span class=w> </span><span class=k>group</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=n>kepler_id</span><span class=w> </span><span class=k>having</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>koi_name</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>1</span><span class=w> </span><span class=k>order</span><span class=w> </span><span class=k>by</span><span class=w> </span><span class=k>count</span><span class=p>(</span><span class=n>koi_name</span><span class=p>)</span><span class=w> </span><span class=k>desc</span><span class=p>;</span>
</code></pre></div> <p>Which Earth sized planets are in the inhabitable zone of the host star?</p> <p>To work out which planets are in the habitable zone, we'll consider the energy budget of a planet. How much energy it receives from its star versus how much it radiates back into space. The intensity of the energy decrease the further the planet is from its star. The incoming energy budget of the planet clearly depends on the brightness of its star, and how close the planet is to that star.</p> <p>The insulation flux for earth is 1361 W/ m2</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "navigation.instant", "navigation.tracking", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../assets/javascripts/bundle.1e8ae164.min.js></script> </body> </html>